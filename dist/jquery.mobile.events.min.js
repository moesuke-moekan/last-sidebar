/**
 * jquery.mobile.vmouse.js
 *
 * https://github.com/jquery/jquery-mobile/blob/1.3.1/js/jquery.mobile.vmouse.js
 *
 * Copyright 2010, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
!function(t,e,n,o){function i(t){for(;t&&void 0!==t.originalEvent;)t=t.originalEvent;return t}function r(e,n){var r,a,s,c,u,l,h,v,p,d=e.type;if(e=t.Event(e),e.type=n,r=e.originalEvent,a=t.event.props,d.search(/^(mouse|click)/)>-1&&(a=P),r)for(h=a.length,c;h;)e[c=a[--h]]=r[c];if(d.search(/mouse(down|up)|click/)>-1&&!e.which&&(e.which=1),-1!==d.search(/^touch/)&&(s=i(r),d=s.touches,u=s.changedTouches,l=d&&d.length?d[0]:u&&u.length?u[0]:o))for(v=0,p=Y.length;v<p;v++)e[c=Y[v]]=l[c];return e}function a(e){for(var n,o,i={};e;){n=t.data(e,k);for(o in n)n[o]&&(i[o]=i.hasVirtualBinding=!0);e=e.parentNode}return i}function s(e,n){for(var o;e;){if((o=t.data(e,k))&&(!n||o[n]))return e;e=e.parentNode}return null}function c(){F=!1}function u(){F=!0}function l(){V=0,x.length=0,z=!1,u()}function h(){c()}function v(){p(),I=setTimeout(function(){I=0,l()},t.vmouse.resetTimerDuration)}function p(){I&&(clearTimeout(I),I=0)}function d(e,n,o){var i;return(o&&o[e]||!o&&s(n.target,e))&&(i=r(n,e),t(n.target).trigger(i)),i}function f(e){var n=t.data(e.target,y);if(!(z||V&&V===n)){var o=d("v"+e.type,e);o&&(o.isDefaultPrevented()&&e.preventDefault(),o.isPropagationStopped()&&e.stopPropagation(),o.isImmediatePropagationStopped()&&e.stopImmediatePropagation())}}function g(e){var n,o,r=i(e).touches;if(r&&1===r.length&&(n=e.target,(o=a(n)).hasVirtualBinding)){V=Q++,t.data(n,y,V),p(),h(),j=!1;var s=i(e).touches[0];B=s.pageX,N=s.pageY,d("vmouseover",e,o),d("vmousedown",e,o)}}function m(t){F||(j||d("vmousecancel",t,a(t.target)),j=!0,v())}function b(e){if(!F){var n=i(e).touches[0],o=j,r=t.vmouse.moveDistanceThreshold,s=a(e.target);(j=j||Math.abs(n.pageX-B)>r||Math.abs(n.pageY-N)>r)&&!o&&d("vmousecancel",e,s),d("vmousemove",e,s),v()}}function w(t){if(!F){u();var e,n=a(t.target);if(d("vmouseup",t,n),!j){var o=d("vclick",t,n);o&&o.isDefaultPrevented()&&(e=i(t).changedTouches[0],x.push({touchID:V,x:e.clientX,y:e.clientY}),z=!0)}d("vmouseout",t,n),j=!1,v()}}function T(e){var n,o=t.data(e,k);if(o)for(n in o)if(o[n])return!0;return!1}function D(){}var E,k="virtualMouseBindings",y="virtualTouchID",X="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),Y="clientX clientY pageX pageY screenX screenY".split(" "),M=t.event.mouseHooks?t.event.mouseHooks.props:[],P=t.event.props.concat(M),S={},I=0,B=0,N=0,j=!1,x=[],z=!1,F=!1,H="addEventListener"in n,L=t(n),Q=1,V=0;t.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var q=0;q<X.length;q++)t.event.special[X[q]]=function(e){var n=e.substr(1);return{setup:function(o,i){T(this)||t.data(this,k,{}),t.data(this,k)[e]=!0,S[e]=(S[e]||0)+1,1===S[e]&&L.bind(n,f),t(this).bind(n,D),H&&(S.touchstart=(S.touchstart||0)+1,1===S.touchstart&&L.bind("touchstart",g).bind("touchend",w).bind("touchmove",b).bind("scroll",m))},teardown:function(o,i){--S[e],S[e]||L.unbind(n,f),H&&(--S.touchstart,S.touchstart||L.unbind("touchstart",g).unbind("touchmove",b).unbind("touchend",w).unbind("scroll",m));var r=t(this),a=t.data(this,k);a&&(a[e]=!1),r.unbind(n,D),T(this)||r.removeData(k)}}}(X[q]);H&&n.addEventListener("click",function(e){var n,o,i,r,a,s=x.length,c=e.target;if(s)for(n=e.clientX,o=e.clientY,E=t.vmouse.clickDistanceThreshold,i=c;i;){for(r=0;r<s;r++)if(a=x[r],0,i===c&&Math.abs(a.x-n)<E&&Math.abs(a.y-o)<E||t.data(i,y)===a.touchID)return e.preventDefault(),void e.stopPropagation();i=i.parentNode}},!0)}(jQuery,window,document),function(t,e,n){function o(e,n,o){var i=o.type;o.type=n,t.event.dispatch.call(e,o),o.type=i}var i=t(document);t.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(e,n){t.fn[n]=function(t){return t?this.bind(n,t):this.trigger(n)},t.attrFn&&(t.attrFn[n]=!0)});var r="ontouchend"in document,a=r?"touchstart":"mousedown",s=r?"touchend":"mouseup",c=r?"touchmove":"mousemove";t.event.special.scrollstart={enabled:!0,setup:function(){function e(t,e){o(r,(n=e)?"scrollstart":"scrollstop",t)}var n,i,r=this;t(r).bind("touchmove scroll",function(o){t.event.special.scrollstart.enabled&&(n||e(o,!0),clearTimeout(i),i=setTimeout(function(){e(o,!1)},50))})}},t.event.special.tap={tapholdThreshold:750,setup:function(){var e=this,n=t(e);n.bind("vmousedown",function(r){function a(){clearTimeout(u)}function s(){a(),n.unbind("vclick",c).unbind("vmouseup",a),i.unbind("vmousecancel",s)}function c(t){s(),l===t.target&&o(e,"tap",t)}if(r.which&&1!==r.which)return!1;var u,l=r.target;r.originalEvent;n.bind("vmouseup",a).bind("vclick",c),i.bind("vmousecancel",s),u=setTimeout(function(){o(e,"taphold",t.Event("taphold",{target:l}))},t.event.special.tap.tapholdThreshold)})}},t.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(e){var n=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[n.pageX,n.pageY],origin:t(e.target)}},stop:function(t){var e=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[e.pageX,e.pageY]}},handleSwipe:function(e,n){n.time-e.time<t.event.special.swipe.durationThreshold&&Math.abs(e.coords[0]-n.coords[0])>t.event.special.swipe.horizontalDistanceThreshold&&Math.abs(e.coords[1]-n.coords[1])<t.event.special.swipe.verticalDistanceThreshold&&e.origin.trigger("swipe").trigger(e.coords[0]>n.coords[0]?"swipeleft":"swiperight")},setup:function(){var e=t(this);e.bind(a,function(n){function o(e){r&&(i=t.event.special.swipe.stop(e),Math.abs(r.coords[0]-i.coords[0])>t.event.special.swipe.scrollSupressionThreshold&&e.preventDefault())}var i,r=t.event.special.swipe.start(n);e.bind(c,o).one(s,function(){e.unbind(c,o),r&&i&&t.event.special.swipe.handleSwipe(r,i),r=i=void 0})})}},t.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(e,n){t.event.special[e]={setup:function(){t(this).bind(n,t.noop)}}})}(jQuery);